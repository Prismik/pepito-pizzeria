extends layout

block content

    link(rel="stylesheet", href="//code.jquery.com/ui/1.10.4/themes/smoothness/jquery-ui.css")
    script(src="//code.jquery.com/jquery-1.10.2.js")
    script(src="//code.jquery.com/ui/1.10.4/jquery-ui.js")
    script.
        $(function() {
        $( "#datepicker" ).datepicker({
        changeMonth:true, 
        changeYear:true, 
        buttonImageOnly:true,
        showOn: "button",
        buttonImage: "../public/images/pizza_clock.png",
        buttonImageOnly: true
        });
        });
        
    script(type='text/javascript').
        var validePassword;
        var valideEmail;
        
        function validatePassword(){
            var password = document.getElementById('password');
            var password1 = document.getElementById('password2');
            var message = document.getElementById('messagePass');
            if (password.value == password1.value) {
                message.style.color="#135F07";
                message.innerHTML = "Passwords match";
                validePassword = true;
            }else{
                message.style.color="#9C000B";
                message.innerHTML = "Passwords don't match";
                validePassword = false;
            }
            validateForm();
        }
        
        function validateEmail(){
            var mail=document.getElementById('inputUserEmail').value;
            var message2 = document.getElementById('messageEmail');
            var at=mail.indexOf("@");
            var dot=mail.lastIndexOf(".");
            if (at<1 || dot<at+2 || dot+2>=mail.length)
            {
                message2.style.color="#9C000B";
                message2.innerHTML = "Not a valide email address";
                valideEmail = false;
            }else{
                valideEmail = true;
                message2.style.color="#135F07";
                message2.innerHTML = "Valide email address";
            }  
            validateForm();  
        }
        function validateForm(){
            var btnSubmit = document.getElementById("btnSubmit");
            if (valideEmail && validePassword)
            {
                btnSubmit.disabled=false;
            }else{
                btnSubmit.disabled=true;
            }
        }
        function addAddressInput(){
            var lastdiv = $(".addressDiv").last();
            var num = lastdiv.children("input").attr("data-num") + 1

            var newdiv = lastdiv.clone();
            newdiv.children("label").html(" ")
            newdiv.children("input").first().attr("id","inputUseraddress" + num).attr("data-num", num).attr(value="");
            newdiv.children("input").last().attr("id","inputUserpostalcode" + num).attr("data-num", num).attr(value="");
            newdiv.children("button").attr("id","delAddress"+num).attr("onclick","delAddressInput("+num+")").html("Delete");
           
            lastdiv.after(newdiv);
        }
        function delAddressInput(num)
        {
            var div = $('input[data-num="'+num+'"]').parent();
            div.remove();
        }
        
    h1= header
    form#formAddUser(name="adduser",method="post",action="users/add")
    
        label Username

        input#inputUserName(type="text", placeholder="Complete name", name="username")

        br

        label Birthdate
        
        input#datepicker(type="text", name="birthdate" readonly)
        
        br
        
        div.addressDiv
            
            label Adresse
            
            input#inputUseraddress1(type="text", placeholder="Complete address", name="address" data-num="1")
            button#addAddress(type="button" onclick="addAddressInput()") Add

            br

            label Postal Code

            input#inputUserPostalCode1(type="text", placeholder="Complete postal code", name="postalcode" data-num="1")
        
        br
        
        label Phone
        
        input#inputUserPhone(type="text", placeholder="Phone number", name="phone")
        
        br

        label Email
        
        input#inputUserEmail(type="text", placeholder="Email", name="email", onkeyup="validateEmail();", onchange="validateEmail();")
        span(id="messageEmail")
        br
        
        label Password
        
        input#password(type="password", placeholder="Password", name="password", onkeyup="validatePassword();", onchange="validatePassword();")
        
        br
        
        label Valid Password
        
        input#password2(type="password", placeholder="Password (again)", name="userpassword2", onkeyup="validatePassword();", onchange="validatePassword();")
        
        span(id="messagePass")
        
        br
        
        button#btnSubmit.sexybutton(type="submit") submit